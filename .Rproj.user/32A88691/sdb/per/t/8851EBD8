{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Exercise 5\"\nauthor: \"Elian Griffioen\"\ndate: \"13 november 2017\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\nIn this exercise, a simulation is performed to learn about confidence intervals.\n100 samples of size 100 are drawn from the standard normal ditribution,\n95-% confidence intervals and the coverage of the population mean are \ncalculated. It is hypothesized that the coverage is close \nto 95 %.\n\n## Drawing samples\n\nFirst, hundred samples of hundred observations were drawn from a standard normal distribution Don't forget to set a seed, since you want to do your work in a \nreproducible manner.\n\n$$X \\sim \\mathcal{N}(0,\\,1)$$\nUsing this code, 100 samples of size 100 are drawn from the standard normal\ndistribution and stored in a list called datasets.\n```{r, echo=TRUE}\n# set seed for reproducibility\nset.seed(123456789)\n\n# create list to store datasets\ndatasets<-list()\n\n# sample hundred times from standard normal distribution sample of size 100\nfor(i in 1:100){\ndatasets[[i]]<-rnorm(100,mean=0,sd=1)\n}\n```\n\n## Simulation of confidence intervals\n\nFor each sample the absolute bias, the standard error and the lower and upper\nbound of the confidence interval are calculated:\n$$ b_{abs} = | \\bar{x} - 0 | = | \\frac{1}{n} \\sum_{i=1}^{n}x_{i} |$$ \n$$se_{\\bar{x}} = \\frac{\\sigma_{x}}{\\sqrt{n}} = \\frac{ \\sqrt{\\frac{\\sum\\limits_{i=1}^{n} \\left(x_{i} - \\bar{x}\\right)^{2}} {n-1}}}{\\sqrt{n}}$$\n\n\n$$ 95 \\%CI = \\bar{x} \\pm z_{.975} \\cdot se_{\\bar{x}} $$\n```{r measures, echo=TRUE}\n# Define vector to store results for each dataset\nabs.bias <- c()\nse <- c()\nn <- length(datasets)\nlowerbound <- c()\nupperbound <- c()\n\n# Calculate absolute bias, standard error of the mean and confidence interval for\n# each dataset\nfor(i in 1:n){\n  abs.bias[i] <- abs(mean(datasets[[i]]))\n  se[i] <- sd(datasets[[i]])/sqrt(n)\n  lowerbound[i] <- mean(datasets[[i]]) - 1.96*se[i]\n  upperbound[i] <- mean(datasets[[i]]) + 1.96*se[i]\n\n}\nconfidence.intervals <- cbind(lowerbound,upperbound)\n```\n\n\n\n## Plotting confidence intervals\n\nThe confidence intervals are plotted together with the population mean to get\nan impression of the number of confidence interval including the population \nmean.\n```{r plot, echo=TRUE}\n# Define a plot with the range of confidence intervals at the x-axis and the\n# dataset numbers at the y-axis\nplot(range(confidence.intervals), c(0, n), type = \"n\",\n     xlab = \"Confidence interval\", ylab = \"Dataset\")\n\n# Add a line segment for each confidence interval\nfor(i in 1:100){\n  segments(confidence.intervals[i,1],i,confidence.intervals[i,2],i,col=\"darkorange\")\n}\n\n# Define an verticle line for the population mean of zero\nabline(v = 0, lwd = 2, lty = 2,col=\"blue\")\n```\n\n## Analyzing the confidence interval\n\nThe coverage is calculated as the proportion of confidence interval containing\nthe population mean. In this way, the hypothesis that the coverage is \napproximately equal to 95 %. Afterwards, the datasets that do not contain the\npopulation mean are tabulated in Table 1.\n\n```{r}\n# Calculate number of confidence interval that do not contain population mean\nout <- sum(confidence.intervals[,1] < 0  & confidence.intervals[,2] < 0) + \n  sum(confidence.intervals[,1] > 0  & confidence.intervals[,2] > 0) \n\n# Coverage is proportion of confidence intervals that contain population mean\n(coverage <- (n-out)/n)\n\n# Acquire indices for confidence interval without population mean\nindices.low <- confidence.intervals[,1] < 0  & confidence.intervals[,2] < 0\nindices.high <- confidence.intervals[,1] > 0  & confidence.intervals[,2] > 0\n\n# Bind indices \nindices <- rep(NA,100)\nindices[indices.low==TRUE] <- TRUE\nindices[indices.high==TRUE] <- TRUE\nindices[is.na(indices)] <- FALSE\n\n# Get datasets that do not contain population mean\nout.datasets <- datasets[indices]\nout.datasets.dataframe <- cbind.data.frame(out.datasets[[1]],out.datasets[[2]],\n                                           out.datasets[[3]],out.datasets[[4]],\n                                           out.datasets[[5]],out.datasets[[6]])\ncolnames(out.datasets.dataframe) <- rep(1:100)[indices]\n\n# Tabulate these datasets\nknitr::kable(out.datasets.dataframe,format=\"html\",caption = \"Table 1. Overview of datasets that do not contain population mean of zero\")\n\n```\n\n\n## Conclusion\n\nThe coverage is .94, which is in agreement with the hypothesis.So the 95 % in \n95-% confidence interval can be interpreted as the proportion of samples from a\npopulation that contain the true population mean, i.e. the long-run probability\nof a sample that contains the population mean.",
    "created" : 1510947068603.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2967347411",
    "id" : "8851EBD8",
    "lastKnownWriteTime" : 1510951666,
    "last_content_update" : 1510951787134,
    "path" : "~/Documents/Documents/Universiteit/Master/MSBBSS/Markup languages and reproducible programming/Week 4/Exercise 5.Rmd",
    "project_path" : "Exercise 5.Rmd",
    "properties" : {
        "last_setup_crc32" : ""
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}